<template>
  <template
    if:true={items.length}
    for:each={items}
    for:item="item"
    for:index="itemIndex"
  >
    <ul
      key={item.id}
      aria-labelledby="treeheading"
      class="slds-tree"
      role="tree"
    >
      <li
        aria-level={index}
        role="treeitem"
        tabindex="0"
        data-key={itemIndex}
        aria-selected="false"
        aria-expanded={item.expanded}
        onclick={selectItem}
        data-name={item.name}
        onblur={handleBlur}
        onfocus={handleFocus}
      >
        <div class="slds-tree__item">
          <template if:false={item.disabled}>
            <c-button
              icon-url={iconUrl}
              data-key={itemIndex}
              extraclass="slds-button_icon slds-m-right_x-small"
              title=""
              icon-name="utility:chevronright"
              icon-size="x-small"
              theme={theme}
              onclick={toggleTree}
              if:true={item.items}
              class={item.subItemClass}
            ></c-button>
          </template>
          <span
            class="slds-has-flexi-truncate"
            onclick={selectItemName}
            data-key={itemIndex}
          >
            <a href={item.href} tabindex="-1" role="presentation">
              <span
                class="slds-tree__item-label slds-truncate"
                title={item.label}
                >{item.label}</span
              >
              <span
                if:true={item.metatext}
                class="slds-tree__item-meta slds-truncate"
                title={item.metatext}
                >{item.metatext}</span
              >
            </a>
          </span>
        </div>
        <c-tree-item
          if:false={item.disabled}
          items={item.items}
          index={index}
          role="group"
        ></c-tree-item>
      </li>
    </ul>
  </template>
</template>
