/*************************************************************************
 *
 * VLOCITY, INC. CONFIDENTIAL
 * __________________
 *
 *  [2014] - [2020] Vlocity, Inc.
 *  All Rights Reserved.
 *
 * NOTICE:  All information contained herein is, and remains
 * the property of Vlocity, Inc. and its suppliers,
 * if any. The intellectual and technical concepts contained
 * herein are proprietary to Vlocity, Inc. and its suppliers and may be
 * covered by U.S. and Foreign Patents, patents in process, and are
 * protected by trade secret or copyright law. Dissemination of this
 * information and reproduction, modification or reverse-engineering
 * of this material, is prohibited unless prior written permission
 * is obtained from Vlocity, Inc.
 *
 * Build: v234.0.0
 */
import { createElement } from "lwc";
import VlocityCheckboxImageGroup from "c/checkboxImageGroup";

describe("c-checkbox-image-group", () => {
  afterEach(() => {
    while (document.body.firstChild) {
      document.body.removeChild(document.body.firstChild);
    }
  });

  it("renders DOM elements", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      { name: "others", value: "others", imgId: "", selected: false }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    expect(element.shadowRoot.children).not.toHaveLength(0);
  });

  /**
   * Check if the theme is applied properly
   */
  it("Check if theme is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      { name: "others", value: "others", imgId: "", selected: false }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.options = radioItems1;
    element.enabledCaption = true;
    element.isImage = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    const button = element.shadowRoot.querySelector("label");
    let index = button.className.indexOf("slds") !== -1 ? true : false;
    expect(index).toBe(true);
  });

  /* Check if the label is set */
  it("Check If label is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      { name: "others", value: "others", imgId: "", selected: false }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.options = radioItems1;
    element.isImage = true;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    const label = element.shadowRoot.querySelector("fieldset");
    expect(label.textContent).toBe("checkbox");
  });

  /* Check if the image is displayed */
  it("Check If image is displayed", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      { name: "others", value: "others", imgId: "", selected: false }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    element.isImageDisplay = true;
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector("img");
    expect(image.src).toBe(
      "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg"
    );
  });

  /* Check if the enabledCaption is set */
  it("Check If enabledCaption is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    const image = element.getElementsByClassName("vlc-caption-out_cont")[0];
    expect(image).not.toBe(null);
  });

  /* Check if the image label is set */
  it("Check If image label is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector(".captionOut");
    expect(image.textContent).toBe("male");
  });

  /* Check if the image value is set */
  it("Check If image value is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.imageCountInRow = 3;
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector(".slds-img-item-caption");
    expect(image.textContent).toBe("others");
  });

  /* Check if the controlWidth is set */
  it("Check If controlWidth is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.theme = "slds";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.controlWidth = 300;
    element.options = radioItems1;
    element.enabledCaption = true;
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector(".vlc-img_select-container");
    const label = element.shadowRoot.querySelector(".slds-static-wrapper")
      .lastChild;
    const parentDiv = element.shadowRoot.querySelector("input").parentNode;
    let index =
      label.className.indexOf("slds-img_option-width-height") !== -1
        ? true
        : false;
    let wrapper =
      parentDiv.className.indexOf("slds-static-wrapper") !== -1 ? true : false;
    expect(wrapper).toBe(true);
    expect(index).toBe(true);
    expect(image.style.width).toBe("300px");
  });

  /* Check if the controlHeight is set */
  it("Check If controlHeight is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.theme = "nds";
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.controlWidth = 200;
    element.controlHeight = 300;
    element.options = radioItems1;
    element.enabledCaption = true;
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector(".vlc-img_select-container");
    const label = element.shadowRoot.querySelector(".nds-static-wrapper")
      .lastChild;
    const parentDiv = element.shadowRoot.querySelector("input").parentNode;
    let index =
      label.className.indexOf("nds-checkbox__label") !== -1 ? true : false;
    let wrapper =
      parentDiv.className.indexOf("nds-static-wrapper") !== -1 ? true : false;
    expect(wrapper).toBe(true);
    expect(index).toBe(true);
    expect(image.style.height).toBe("300px");
  });

  /* Check if the imageCountInRow is set */
  it("Check If imageCountInRow is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: false
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.imageCountInRow = 3;
    element.options = radioItems1;
    element.enabledCaption = true;
    element.theme = "slds";
    document.body.appendChild(element);
    const image = element.shadowRoot.querySelector(".vlc-img-wrapper");
    let width = element.theme + "-size_1-of-" + element.imageCountInRow;
    let aspectRatio = 100 / element.imageCountInRow + "%";
    const parentDiv = element.shadowRoot.querySelector("input").parentNode;
    const label = image.lastChild;
    let index =
      label.className.indexOf("slds-img_no-width-height") !== -1 ? true : false;
    let wrapper =
      parentDiv.className.indexOf("vlc-img-wrapper") !== -1 ? true : false;
    expect(wrapper).toBe(true);
    expect(index).toBe(true);
    expect(image.classList.contains(width)).toBe(true);
    expect(image.style.paddingTop).toBe(aspectRatio);
  });

  /* Check if the value is checked */
  it("Check If value is checked", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg"
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg"
      },
      { name: "others", value: "others", label: "others", imgId: "" }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.imageCountInRow = 3;
    element.options = radioItems1;
    element.value = "female";
    element.enabledCaption = true;
    document.body.appendChild(element);
    const input = element.shadowRoot.querySelectorAll("input")[1];
    expect(input.checked).toBe(true);
  });

  /* Check if the value is set */
  it("Check If value is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: true
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.imageCountInRow = 3;
    element.options = radioItems1;
    element.enabledCaption = true;
    document.body.appendChild(element);
    const input = element.shadowRoot.querySelectorAll("input");
    input[0].click();
    input[1].click();
    return Promise.resolve().then(() => {
      expect(element.value).toBe("male;female");
    });
  });

  /* Check if the isDisplayCheckbox works */
  it("Check If isDisplayCheckbox works", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isDisplayCheckbox = true;
    document.body.appendChild(element);
    const input = element.shadowRoot.querySelectorAll("input").length;
    expect(input).toBe(1);
  });

  /* Check if the isImage is set */
  it("Check If isImage is set", () => {
    const element = createElement("c-checkbox-image-group", {
      is: VlocityCheckboxImageGroup
    });
    let radioItems1 = [
      {
        name: "male",
        value: "male",
        label: "male",
        imgId:
          "https://image.shutterstock.com/image-photo/summer-beach-holiday-online-shopping-450w-461355724.jpg",
        selected: true
      },
      {
        name: "female",
        value: "female",
        label: "female",
        imgId:
          "https://cdn.pixabay.com/photo/2015/11/06/15/13/internet-1028794__340.jpg",
        selected: true
      },
      {
        name: "others",
        value: "others",
        label: "others",
        imgId: "",
        selected: false
      }
    ];
    element.name = "Checkbox image group";
    element.type = "checkbox";
    element.label = "checkbox";
    element.isImage = true;
    element.imageCountInRow = 3;
    element.options = radioItems1;
    element.enabledCaption = true;
    document.body.appendChild(element);
    const input = element.shadowRoot.querySelectorAll("input").length;
    expect(input).toBe(3);
  });
});
