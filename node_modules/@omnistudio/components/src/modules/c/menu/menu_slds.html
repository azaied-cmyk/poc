<template>
  <div class="slds-dropdown-trigger slds-dropdown-trigger_click">
    <c-button
      theme="slds"
      label={interpolatedLabel}
      icon-url={iconUrl}
      type="button"
      styles={styles}
      onclick={toggleMenu}
      onmousedown={handleDropdownMouseDown}
      onblur={hideMenuDropDown}
      extraclass={extraClass}
      icon-name={iconName}
      icon-size={iconSize}
      icon-fill={iconColor}
      variant={variant}
      icon-position={iconPosition}
      disabled={disabled}
      id="menubutton-id"
      aria-haspopup="true"
      aria-controls="menu-id"
      aria-expanded={isMenuDisplayed}
    >
    </c-button>
    <div
      class={dropdownClass}
      onopenmenumodal={handleOpenModal}
      onclosemenumodal={handleCloseModal}
    >
      <div onmousedown={handleDropdownMouseDown}>
        <ul
          class="slds-dropdown__list"
          id="menu-id"
          role="menu"
          aria-labelledby="menubutton-id"
        >
          <template if:false={menuItems}>
            <slot></slot>
          </template>
          <template if:true={menuItems}>
            <template for:each={menuItems} for:item="item">
              <span key={item.name}>
                <c-menu-item
                  record={item.record}
                  icon-name={item.iconName}
                  action-url={item.actionUrl}
                  open-url-in={item.openUrlIn}
                  icon-position={item.iconPosition}
                  icon-text={item.iconText}
                  theme="slds"
                  obj={record}
                  action-data={item.actionData}
                  label={item.label}
                  checked={item.checked}
                  status={item.status}
                  icon-url={item.iconUrl}
                  name={item.name}
                  type={item.type}
                >
                </c-menu-item>
              </span>
            </template>
          </template>
        </ul>
      </div>
    </div>
  </div>
  <c-modal size="medium" class="menuItemFlyout" onclose={hideFlyout}>
    <div slot="content" class="slds-is-relative">
      <slot name="flyout"></slot>
    </div>
  </c-modal>
</template>
