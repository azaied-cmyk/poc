<template>
  <article class="slds-card">
    <div if:false={isLoaded}>
      <c-spinner
        variant="brand"
        size="medium"
        alternative-text="loading"
      ></c-spinner>
    </div>
    <div class="slds-card__body chart-container" style="position: relative;">
      <canvas lwc:dom="manual" class="chart-canvas"></canvas>
    </div>
    <div if:true={hasAccessibilitySupport} class="slds-section tableSection">
      <h6 onclick={toggleSection}>
        <button
          aria-controls="table-section"
          aria-expanded={isTableExpanded}
          class="slds-button slds-section__title-action"
        >
          <span class="slds-m-right_small">
            <c-icon
              icon-name={iconName}
              extraclass="slds-icon"
              theme="slds"
              size="x-small"
            >
            </c-icon>
          </span>
          <span class="slds-truncate" title={title} id="table-title"
            >Datatable for {title}</span
          >
        </button>
      </h6>
      <div
        aria-hidden={isTableCollapsed}
        class="slds-section__content"
        id="table-section"
      >
        <table
          class="slds-table slds-table_cell-buffer slds-table_bordered"
          aria-labelled-by="table-title"
        >
          <thead>
            <tr class="slds-line-height_reset">
              <template
                for:each={tableHeader}
                for:item="item"
                for:index="index"
              >
                <th key={item.id} class="" scope="col">
                  <div class="slds-truncate slds-text-title" title={item.name}>
                    {item.name}
                  </div>
                </th>
              </template>
            </tr>
          </thead>
          <tbody>
            <template
              for:each={tableRows}
              for:item="rowObj"
              for:index="rowIndex"
            >
              <tr key={rowObj.id} class="slds-hint-parent">
                <template
                  for:each={rowObj.row}
                  for:item="item"
                  for:index="index"
                >
                  <td key={item.id}>
                    <div
                      class="slds-truncate slds-text-body_small"
                      title={item.name}
                    >
                      {item.name}
                    </div>
                  </td>
                </template>
              </tr>
            </template>
          </tbody>
        </table>
      </div>
    </div>
  </article>
  <div class="vlocity-toast-container vlocity-toast-container_top-right">
    <c-toast class="slds-hide"> </c-toast>
  </div>
</template>
